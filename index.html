<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Grand - Leitstelle</title>

<style>
:root{
--bg:#0b0e14;--card:#151921;--accent:#ff2e7e;
--border:#21262d;--text:#fff;--muted:#8b949e
}
*{box-sizing:border-box;font-family:Segoe UI,sans-serif}
body{margin:0;background:var(--bg);color:var(--text);height:100vh}

/* LOGIN */
#loginScreen{
position:fixed;inset:0;
display:flex;justify-content:center;align-items:center;
background:rgba(10,12,18,.85);backdrop-filter:blur(20px);z-index:1000
}
.login-box{
background:var(--card);border:1px solid var(--border);
border-radius:18px;padding:30px;width:320px
}
.login-box input,.login-box button{
width:100%;margin-top:8px;padding:10px;border-radius:6px
}
.login-box input{
background:#0a0c10;border:1px solid #333;color:#fff
}
.login-box button{
background:var(--accent);border:none;font-weight:600;cursor:pointer
}

/* APP */
#app{display:none;height:100vh}
.topbar{
display:flex;gap:6px;background:var(--card);
border-bottom:1px solid var(--border);padding:10px
}
.tab{
padding:6px 12px;border-radius:6px;
cursor:pointer;font-size:12px;color:var(--muted)
}
.tab.active{background:rgba(255,46,126,.2);color:var(--accent)}
.hidden{display:none}

.content{padding:15px}
.card{
background:var(--card);border:1px solid var(--border);
border-radius:14px;padding:15px;margin-bottom:15px
}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="loginScreen">
<div class="login-box">
<h3>MDT Login</h3>
<input id="loginUser" placeholder="Benutzer">
<input id="loginPin" type="password" placeholder="PIN">
<button id="loginBtn">Login</button>
</div>
</div>

<!-- APP -->
<div id="app">
<div class="topbar">
<div class="tab active" data-view="dashboard">Leitstelle</div>
<div class="tab" data-view="rechner">Strafrechner</div>
<div class="tab hidden" id="adminTab" data-view="admin">Admin</div>
<div class="tab hidden" id="accessTab" data-view="access">Zugriffe</div>
<div class="tab" id="logoutBtn">Logout</div>
</div>

<div class="content">
<div id="dashboard" class="view">
<div class="card">Leitstellen Übersicht</div>
</div>

<div id="rechner" class="view hidden">
<div class="card">Strafrechner (Platzhalter)</div>
</div>

<div id="admin" class="view hidden">
<div class="card">
<h4>User Verwaltung</h4>
<input id="newUser" placeholder="Benutzer">
<input id="newPin" placeholder="PIN">
<select id="newRole">
<option value="user">User</option>
<option value="admin">Admin</option>
</select>
<button onclick="addUser()">Hinzufügen</button>
<div id="userList"></div>
</div>
</div>

<div id="access" class="view hidden">
<div class="card">
<h4>Zugriffsrechte</h4>
<div id="accessList"></div>
</div>
</div>
</div>
</div>

<script>
document.addEventListener("DOMContentLoaded",()=>{

/* INIT STORAGE */
if(!localStorage.users){
localStorage.users=JSON.stringify([
{u:"ADMIN",p:"9999",r:"admin",active:true},
{u:"LSPD",p:"1234",r:"user",active:true}
])
}

let currentUser=null;

/* LOGIN */
document.getElementById("loginBtn").onclick=()=>{
const u=document.getElementById("loginUser").value.trim().toUpperCase();
const p=document.getElementById("loginPin").value;
const users=JSON.parse(localStorage.users);

const found=users.find(x=>x.u===u && x.p===p && x.active);
if(!found){alert("Login fehlgeschlagen");return;}

currentUser=found;
document.getElementById("loginScreen").style.display="none";
document.getElementById("app").style.display="block";

if(found.r==="admin"){
document.getElementById("adminTab").classList.remove("hidden");
document.getElementById("accessTab").classList.remove("hidden");
}

renderUsers();
renderAccess();
};

/* NAV */
document.querySelectorAll(".tab").forEach(t=>{
t.onclick=()=>{
if(t.id==="logoutBtn"){location.reload();return;}
document.querySelectorAll(".view").forEach(v=>v.classList.add("hidden"));
document.getElementById(t.dataset.view)?.classList.remove("hidden");
document.querySelectorAll(".tab").forEach(x=>x.classList.remove("active"));
t.classList.add("active");
}
});

/* USERS */
window.addUser=()=>{
const users=JSON.parse(localStorage.users);
users.push({
u:newUser.value,
p:newPin.value,
r:newRole.value,
active:true
});
localStorage.users=JSON.stringify(users);
renderUsers();renderAccess();
};

function renderUsers(){
const users=JSON.parse(localStorage.users);
userList.innerHTML=users.map(x=>
`${x.u} | ${x.r} | ${x.active?"aktiv":"gesperrt"}`
).join("<br>");
}

/* ACCESS */
function renderAccess(){
const users=JSON.parse(localStorage.users);
accessList.innerHTML=users.map((x,i)=>`
${x.u} 
<button onclick="toggleAccess(${i})">
${x.active?"Sperren":"Freigeben"}
</button>`
).join("<br>");
}

window.toggleAccess=(i)=>{
const users=JSON.parse(localStorage.users);
users[i].active=!users[i].active;
localStorage.users=JSON.stringify(users);
renderUsers();renderAccess();
};

});
</script>

</body>
</html>

