<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>MDT System</title>

<style>
:root{
--bg:#0b0e14;--card:#151921;--accent:#ff2e7e;
--border:#21262d;--text:#fff;--muted:#8b949e
}
*{box-sizing:border-box;font-family:Segoe UI,sans-serif}
body{margin:0;background:var(--bg);color:var(--text);height:100vh}

/* LOGIN */
#loginScreen{
position:fixed;inset:0;display:flex;justify-content:center;align-items:center;
background:rgba(10,12,18,.85);backdrop-filter:blur(20px);z-index:1000
}
.login-box{
background:var(--card);border:1px solid var(--border);
border-radius:18px;padding:30px;width:320px
}
.login-box input,.login-box button{
width:100%;margin-top:8px;padding:10px;border-radius:6px
}
.login-box input{
background:#0a0c10;border:1px solid #333;color:#fff
}
.login-box button{
background:var(--accent);border:none;font-weight:600;cursor:pointer
}

/* APP */
#app{display:none;height:100vh}
.topbar{
display:flex;gap:6px;background:var(--card);
border-bottom:1px solid var(--border);padding:10px
}
.tab{
padding:6px 12px;border-radius:6px;
cursor:pointer;font-size:12px;color:var(--muted)
}
.tab.active{background:rgba(255,46,126,.2);color:var(--accent)}
.hidden{display:none}
.content{padding:15px}

.card{
background:var(--card);border:1px solid var(--border);
border-radius:14px;padding:15px;margin-bottom:15px
}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:10px}
button{cursor:pointer}
input,select{
background:#0a0c10;border:1px solid #333;color:#fff;
padding:8px;border-radius:6px;margin-top:5px;width:100%
}
.small{font-size:12px;color:var(--muted)}
hr{border:0;border-top:1px solid var(--border);margin:10px 0}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="loginScreen">
<div class="login-box">
<h3>MDT Login</h3>
<input id="loginUser" placeholder="Benutzer">
<input id="loginPin" type="password" placeholder="PIN">
<button id="loginBtn">Login</button>
</div>
</div>

<!-- APP -->
<div id="app">
<div class="topbar">
<div class="tab active" data-view="dashboard">Leitstelle</div>
<div class="tab" data-view="laws">Gesetze</div>
<div class="tab hidden" id="adminTab" data-view="admin">Admin</div>
<div class="tab" id="logoutBtn">Logout</div>
</div>

<div class="content">

<!-- DASHBOARD -->
<div id="dashboard" class="view">
<div class="grid">
<div class="card">
<b>Aktive Benutzer</b>
<div id="statActive"></div>
</div>
<div class="card">
<b>Gesperrte Benutzer</b>
<div id="statBlocked"></div>
</div>
<div class="card">
<b>Gesetze gesamt</b>
<div id="statLaws"></div>
</div>
</div>
</div>

<!-- LAWS -->
<div id="laws" class="view hidden">
<div class="card">
<h4>Gesetze</h4>
<div id="lawList"></div>
</div>
</div>

<!-- ADMIN -->
<div id="admin" class="view hidden">

<div class="card">
<h4>Admin Passwort ändern</h4>
<input id="newAdminPin" placeholder="Neue PIN">
<button onclick="changeAdminPin()">Ändern</button>
</div>

<div class="card">
<h4>Benutzerverwaltung</h4>
<input id="uName" placeholder="Benutzer">
<input id="uPin" placeholder="PIN">
<select id="uRole">
<option value="user">User</option>
<option value="admin">Admin</option>
</select>
<button onclick="addUser()">Hinzufügen</button>
<hr>
<div id="userList"></div>
</div>

<div class="card">
<h4>Gesetz hinzufügen</h4>
<input id="lPara" placeholder="Paragraph">
<input id="lDesc" placeholder="Beschreibung">
<input id="lWant" placeholder="Wanteds">
<input id="lFine" placeholder="Geld">
<button onclick="addLaw()">Hinzufügen</button>
</div>

</div>

</div>
</div>

<script>
document.addEventListener("DOMContentLoaded",()=>{

/* INIT */
if(!localStorage.users){
localStorage.users=JSON.stringify([
{u:"ADMIN",p:"9999",r:"admin",active:true},
{u:"LSPD",p:"1234",r:"user",active:true}
])
}
if(!localStorage.laws){
localStorage.laws=JSON.stringify([
{p:"BtMG §2.1",d:"Drogenbesitz Klein",w:1,f:15000}
])
}

let currentUser=null;

/* LOGIN */
loginBtn.onclick=()=>{
const u=loginUser.value.trim().toUpperCase();
const p=loginPin.value.trim();
const users=JSON.parse(localStorage.users);
const found=users.find(x=>x.u===u && x.p===p && x.active);
if(!found){alert("Login fehlgeschlagen");return;}
currentUser=found;
loginScreen.style.display="none";
app.style.display="block";
if(found.r==="admin") adminTab.classList.remove("hidden");
renderAll();
};

/* NAV */
document.querySelectorAll(".tab").forEach(t=>{
t.onclick=()=>{
if(t.id==="logoutBtn"){location.reload();return;}
document.querySelectorAll(".view").forEach(v=>v.classList.add("hidden"));
document.getElementById(t.dataset.view)?.classList.remove("hidden");
document.querySelectorAll(".tab").forEach(x=>x.classList.remove("active"));
t.classList.add("active");
}
});

/* DASHBOARD */
function renderStats(){
const users=JSON.parse(localStorage.users);
statActive.innerText=users.filter(x=>x.active).length;
statBlocked.innerText=users.filter(x=>!x.active).length;
statLaws.innerText=JSON.parse(localStorage.laws).length;
}

/* USERS */
function renderUsers(){
const users=JSON.parse(localStorage.users);
userList.innerHTML=users.map((x,i)=>`
${x.u} (${x.r}) - ${x.active?"aktiv":"gesperrt"}
<button onclick="toggleUser(${i})">Toggle</button>
<button onclick="delUser(${i})">X</button>
`).join("<br>");
}
window.addUser=()=>{
const users=JSON.parse(localStorage.users);
users.push({
u:uName.value.trim().toUpperCase(),
p:uPin.value,
r:uRole.value,
active:true
});
localStorage.users=JSON.stringify(users);
renderAll();
};
window.toggleUser=i=>{
const users=JSON.parse(localStorage.users);
users[i].active=!users[i].active;
localStorage.users=JSON.stringify(users);
renderAll();
};
window.delUser=i=>{
const users=JSON.parse(localStorage.users);
users.splice(i,1);
localStorage.users=JSON.stringify(users);
renderAll();
};

/* ADMIN PIN */
window.changeAdminPin=()=>{
const users=JSON.parse(localStorage.users);
const admin=users.find(x=>x.u==="ADMIN");
admin.p=newAdminPin.value;
localStorage.users=JSON.stringify(users);
alert("PIN geändert");
};

/* LAWS */
function renderLaws(){
const laws=JSON.parse(localStorage.laws);
lawList.innerHTML=laws.map((x,i)=>`
${x.p} – ${x.d} | ${x.w}W | $${x.f}
<button onclick="delLaw(${i})">X</button>
`).join("<br>");
}
window.addLaw=()=>{
const laws=JSON.parse(localStorage.laws);
laws.push({p:lPara.value,d:lDesc.value,w:lWant.value,f:lFine.value});
localStorage.laws=JSON.stringify(laws);
renderAll();
};
window.delLaw=i=>{
const laws=JSON.parse(localStorage.laws);
laws.splice(i,1);
localStorage.laws=JSON.stringify(laws);
renderAll();
};

function renderAll(){
renderStats();
renderUsers();
renderLaws();
}

});
</script>

</body>
</html>
